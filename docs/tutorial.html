<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Tutorial | Wren Bind c++17</title>
    <meta name="description" content="Wren language binding library for C++17">
    
    
    <link rel="preload" href="/wrenbind17/assets/css/0.styles.f8145da2.css" as="style"><link rel="preload" href="/wrenbind17/assets/js/app.6ecae263.js" as="script"><link rel="preload" href="/wrenbind17/assets/js/2.4fd91003.js" as="script"><link rel="preload" href="/wrenbind17/assets/js/151.bbd6ded7.js" as="script"><link rel="prefetch" href="/wrenbind17/assets/js/10.9503ba54.js"><link rel="prefetch" href="/wrenbind17/assets/js/100.83164e9d.js"><link rel="prefetch" href="/wrenbind17/assets/js/101.0da247ae.js"><link rel="prefetch" href="/wrenbind17/assets/js/102.5e812843.js"><link rel="prefetch" href="/wrenbind17/assets/js/103.6b26bf1c.js"><link rel="prefetch" href="/wrenbind17/assets/js/104.beedac44.js"><link rel="prefetch" href="/wrenbind17/assets/js/105.906d7d57.js"><link rel="prefetch" href="/wrenbind17/assets/js/106.58149b81.js"><link rel="prefetch" href="/wrenbind17/assets/js/107.2c864031.js"><link rel="prefetch" href="/wrenbind17/assets/js/108.15abbc62.js"><link rel="prefetch" href="/wrenbind17/assets/js/109.2b106772.js"><link rel="prefetch" href="/wrenbind17/assets/js/11.cdf214d9.js"><link rel="prefetch" href="/wrenbind17/assets/js/110.dd3dd12d.js"><link rel="prefetch" href="/wrenbind17/assets/js/111.e1f816cc.js"><link rel="prefetch" href="/wrenbind17/assets/js/112.97053d3b.js"><link rel="prefetch" href="/wrenbind17/assets/js/113.554f4172.js"><link rel="prefetch" href="/wrenbind17/assets/js/114.3cb40269.js"><link rel="prefetch" href="/wrenbind17/assets/js/115.c5485325.js"><link rel="prefetch" href="/wrenbind17/assets/js/116.96c0f5dc.js"><link rel="prefetch" href="/wrenbind17/assets/js/117.86f340eb.js"><link rel="prefetch" href="/wrenbind17/assets/js/118.cd8d1b8b.js"><link rel="prefetch" href="/wrenbind17/assets/js/119.6af1bcf8.js"><link rel="prefetch" href="/wrenbind17/assets/js/12.75312f72.js"><link rel="prefetch" href="/wrenbind17/assets/js/120.5d2ed02a.js"><link rel="prefetch" href="/wrenbind17/assets/js/121.f95aaae6.js"><link rel="prefetch" href="/wrenbind17/assets/js/122.9bf69704.js"><link rel="prefetch" href="/wrenbind17/assets/js/123.b209e64f.js"><link rel="prefetch" href="/wrenbind17/assets/js/124.91f9c0fd.js"><link rel="prefetch" href="/wrenbind17/assets/js/125.6e90d869.js"><link rel="prefetch" href="/wrenbind17/assets/js/126.ccae3252.js"><link rel="prefetch" href="/wrenbind17/assets/js/127.7f55695f.js"><link rel="prefetch" href="/wrenbind17/assets/js/128.d37c6b33.js"><link rel="prefetch" href="/wrenbind17/assets/js/129.131bad60.js"><link rel="prefetch" href="/wrenbind17/assets/js/13.2c90b335.js"><link rel="prefetch" href="/wrenbind17/assets/js/130.ba391920.js"><link rel="prefetch" href="/wrenbind17/assets/js/131.c115e62a.js"><link rel="prefetch" href="/wrenbind17/assets/js/132.d6f19334.js"><link rel="prefetch" href="/wrenbind17/assets/js/133.025876f4.js"><link rel="prefetch" href="/wrenbind17/assets/js/134.0c9800ef.js"><link rel="prefetch" href="/wrenbind17/assets/js/135.ac7865aa.js"><link rel="prefetch" href="/wrenbind17/assets/js/136.b50c8069.js"><link rel="prefetch" href="/wrenbind17/assets/js/137.4e542004.js"><link rel="prefetch" href="/wrenbind17/assets/js/138.8b1301b6.js"><link rel="prefetch" href="/wrenbind17/assets/js/139.81b37090.js"><link rel="prefetch" href="/wrenbind17/assets/js/14.e667e5d8.js"><link rel="prefetch" href="/wrenbind17/assets/js/140.505252f6.js"><link rel="prefetch" href="/wrenbind17/assets/js/141.4dd6be37.js"><link rel="prefetch" href="/wrenbind17/assets/js/142.54ae2186.js"><link rel="prefetch" href="/wrenbind17/assets/js/143.ab322207.js"><link rel="prefetch" href="/wrenbind17/assets/js/144.ba76f975.js"><link rel="prefetch" href="/wrenbind17/assets/js/145.d1e1c832.js"><link rel="prefetch" href="/wrenbind17/assets/js/146.662fe27e.js"><link rel="prefetch" href="/wrenbind17/assets/js/147.698de82c.js"><link rel="prefetch" href="/wrenbind17/assets/js/148.643f0078.js"><link rel="prefetch" href="/wrenbind17/assets/js/149.e15469f9.js"><link rel="prefetch" href="/wrenbind17/assets/js/15.56f3789a.js"><link rel="prefetch" href="/wrenbind17/assets/js/150.ffaff273.js"><link rel="prefetch" href="/wrenbind17/assets/js/152.9c00f83b.js"><link rel="prefetch" href="/wrenbind17/assets/js/16.54a864ba.js"><link rel="prefetch" href="/wrenbind17/assets/js/17.a10414c2.js"><link rel="prefetch" href="/wrenbind17/assets/js/18.6558497c.js"><link rel="prefetch" href="/wrenbind17/assets/js/19.4c3516ba.js"><link rel="prefetch" href="/wrenbind17/assets/js/20.90a9686a.js"><link rel="prefetch" href="/wrenbind17/assets/js/21.d4d65da5.js"><link rel="prefetch" href="/wrenbind17/assets/js/22.81e349d2.js"><link rel="prefetch" href="/wrenbind17/assets/js/23.f7fcce38.js"><link rel="prefetch" href="/wrenbind17/assets/js/24.333418b1.js"><link rel="prefetch" href="/wrenbind17/assets/js/25.b3350bdf.js"><link rel="prefetch" href="/wrenbind17/assets/js/26.03026bbe.js"><link rel="prefetch" href="/wrenbind17/assets/js/27.096b3c0c.js"><link rel="prefetch" href="/wrenbind17/assets/js/28.d76fb0d4.js"><link rel="prefetch" href="/wrenbind17/assets/js/29.072d3708.js"><link rel="prefetch" href="/wrenbind17/assets/js/3.61464b9d.js"><link rel="prefetch" href="/wrenbind17/assets/js/30.1722a862.js"><link rel="prefetch" href="/wrenbind17/assets/js/31.5ccd7b3a.js"><link rel="prefetch" href="/wrenbind17/assets/js/32.6cfebbae.js"><link rel="prefetch" href="/wrenbind17/assets/js/33.ba9bca56.js"><link rel="prefetch" href="/wrenbind17/assets/js/34.0729fc13.js"><link rel="prefetch" href="/wrenbind17/assets/js/35.70056505.js"><link rel="prefetch" href="/wrenbind17/assets/js/36.1f7b9996.js"><link rel="prefetch" href="/wrenbind17/assets/js/37.a037c224.js"><link rel="prefetch" href="/wrenbind17/assets/js/38.2c55cf2b.js"><link rel="prefetch" href="/wrenbind17/assets/js/39.7185105f.js"><link rel="prefetch" href="/wrenbind17/assets/js/4.0ed12f5a.js"><link rel="prefetch" href="/wrenbind17/assets/js/40.3449d70b.js"><link rel="prefetch" href="/wrenbind17/assets/js/41.45f9bb2b.js"><link rel="prefetch" href="/wrenbind17/assets/js/42.cc98d64e.js"><link rel="prefetch" href="/wrenbind17/assets/js/43.02d87f9f.js"><link rel="prefetch" href="/wrenbind17/assets/js/44.c599a919.js"><link rel="prefetch" href="/wrenbind17/assets/js/45.4f184aaa.js"><link rel="prefetch" href="/wrenbind17/assets/js/46.42346e2c.js"><link rel="prefetch" href="/wrenbind17/assets/js/47.ba830368.js"><link rel="prefetch" href="/wrenbind17/assets/js/48.faa4c961.js"><link rel="prefetch" href="/wrenbind17/assets/js/49.1a63e74d.js"><link rel="prefetch" href="/wrenbind17/assets/js/5.3e3a0d57.js"><link rel="prefetch" href="/wrenbind17/assets/js/50.ea5e2efd.js"><link rel="prefetch" href="/wrenbind17/assets/js/51.0cf2d3eb.js"><link rel="prefetch" href="/wrenbind17/assets/js/52.87c7d68e.js"><link rel="prefetch" href="/wrenbind17/assets/js/53.46abff4f.js"><link rel="prefetch" href="/wrenbind17/assets/js/54.dc0bd64b.js"><link rel="prefetch" href="/wrenbind17/assets/js/55.4b215e35.js"><link rel="prefetch" href="/wrenbind17/assets/js/56.dcc3034c.js"><link rel="prefetch" href="/wrenbind17/assets/js/57.0e592c96.js"><link rel="prefetch" href="/wrenbind17/assets/js/58.f77d29d6.js"><link rel="prefetch" href="/wrenbind17/assets/js/59.454cabed.js"><link rel="prefetch" href="/wrenbind17/assets/js/6.6e94312e.js"><link rel="prefetch" href="/wrenbind17/assets/js/60.e5505274.js"><link rel="prefetch" href="/wrenbind17/assets/js/61.8d4a45a7.js"><link rel="prefetch" href="/wrenbind17/assets/js/62.a83f145c.js"><link rel="prefetch" href="/wrenbind17/assets/js/63.744c3ce4.js"><link rel="prefetch" href="/wrenbind17/assets/js/64.94d9faa2.js"><link rel="prefetch" href="/wrenbind17/assets/js/65.02543175.js"><link rel="prefetch" href="/wrenbind17/assets/js/66.2e66e8a0.js"><link rel="prefetch" href="/wrenbind17/assets/js/67.fb6020cc.js"><link rel="prefetch" href="/wrenbind17/assets/js/68.fbeebd70.js"><link rel="prefetch" href="/wrenbind17/assets/js/69.33ad4e99.js"><link rel="prefetch" href="/wrenbind17/assets/js/7.2054f1c6.js"><link rel="prefetch" href="/wrenbind17/assets/js/70.5a667bf1.js"><link rel="prefetch" href="/wrenbind17/assets/js/71.c73b381b.js"><link rel="prefetch" href="/wrenbind17/assets/js/72.473d0b0c.js"><link rel="prefetch" href="/wrenbind17/assets/js/73.4ce5215c.js"><link rel="prefetch" href="/wrenbind17/assets/js/74.7a52578f.js"><link rel="prefetch" href="/wrenbind17/assets/js/75.bbd2ae78.js"><link rel="prefetch" href="/wrenbind17/assets/js/76.180852c4.js"><link rel="prefetch" href="/wrenbind17/assets/js/77.5d4bef73.js"><link rel="prefetch" href="/wrenbind17/assets/js/78.ece83005.js"><link rel="prefetch" href="/wrenbind17/assets/js/79.8636417b.js"><link rel="prefetch" href="/wrenbind17/assets/js/8.2dbeecef.js"><link rel="prefetch" href="/wrenbind17/assets/js/80.4c972ed2.js"><link rel="prefetch" href="/wrenbind17/assets/js/81.e36a4353.js"><link rel="prefetch" href="/wrenbind17/assets/js/82.84b96d7a.js"><link rel="prefetch" href="/wrenbind17/assets/js/83.8af3a0ee.js"><link rel="prefetch" href="/wrenbind17/assets/js/84.970a7c3a.js"><link rel="prefetch" href="/wrenbind17/assets/js/85.36ed4fa3.js"><link rel="prefetch" href="/wrenbind17/assets/js/86.c9a682b9.js"><link rel="prefetch" href="/wrenbind17/assets/js/87.adfbeb3a.js"><link rel="prefetch" href="/wrenbind17/assets/js/88.6350fe22.js"><link rel="prefetch" href="/wrenbind17/assets/js/89.5dc858a8.js"><link rel="prefetch" href="/wrenbind17/assets/js/9.3807d364.js"><link rel="prefetch" href="/wrenbind17/assets/js/90.f53d0a53.js"><link rel="prefetch" href="/wrenbind17/assets/js/91.7b9350b2.js"><link rel="prefetch" href="/wrenbind17/assets/js/92.bc4993b9.js"><link rel="prefetch" href="/wrenbind17/assets/js/93.efb4c3ca.js"><link rel="prefetch" href="/wrenbind17/assets/js/94.909726b7.js"><link rel="prefetch" href="/wrenbind17/assets/js/95.1de2940a.js"><link rel="prefetch" href="/wrenbind17/assets/js/96.2fd28929.js"><link rel="prefetch" href="/wrenbind17/assets/js/97.b04f5a45.js"><link rel="prefetch" href="/wrenbind17/assets/js/98.f8a3d0fa.js"><link rel="prefetch" href="/wrenbind17/assets/js/99.1d072d8c.js">
    <link rel="stylesheet" href="/wrenbind17/assets/css/0.styles.f8145da2.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/wrenbind17/" class="home-link router-link-active"><!----> <span class="site-name">Wren Bind c++17</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/wrenbind17/" class="nav-link">Home</a></div><div class="nav-item"><a href="/wrenbind17/docs/tutorial.html" class="nav-link router-link-exact-active router-link-active">Tutorial</a></div><div class="nav-item"><a href="/wrenbind17/docs/doxygen/modules.html" class="nav-link">Modules</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Classes</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/wrenbind17/docs/doxygen/annotated.html" class="nav-link">Class List</a></li><li class="dropdown-item"><!----> <a href="/wrenbind17/docs/doxygen/classes.html" class="nav-link">Class Index</a></li><li class="dropdown-item"><!----> <a href="/wrenbind17/docs/doxygen/hierarchy.html" class="nav-link">Class Hierarchy</a></li><li class="dropdown-item"><!----> <a href="/wrenbind17/docs/doxygen/class_members.html" class="nav-link">Class Members</a></li><li class="dropdown-item"><!----> <a href="/wrenbind17/docs/doxygen/class_member_functions.html" class="nav-link">Class Member Functions</a></li><li class="dropdown-item"><!----> <a href="/wrenbind17/docs/doxygen/class_member_variables.html" class="nav-link">Class Member Variables</a></li><li class="dropdown-item"><!----> <a href="/wrenbind17/docs/doxygen/class_member_typedefs.html" class="nav-link">Class Member Typedefs</a></li><li class="dropdown-item"><!----> <a href="/wrenbind17/docs/doxygen/class_member_enums.html" class="nav-link">Class Member Enumerations</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Namespaces</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/wrenbind17/docs/doxygen/namespaces.html" class="nav-link">Namespace List</a></li><li class="dropdown-item"><!----> <a href="/wrenbind17/docs/doxygen/namespace_members.html" class="nav-link">Namespace Members</a></li><li class="dropdown-item"><!----> <a href="/wrenbind17/docs/doxygen/namespace_member_functions.html" class="nav-link">Namespace Member Functions</a></li><li class="dropdown-item"><!----> <a href="/wrenbind17/docs/doxygen/namespace_member_variables.html" class="nav-link">Namespace Member Variables</a></li><li class="dropdown-item"><!----> <a href="/wrenbind17/docs/doxygen/namespace_member_typedefs.html" class="nav-link">Namespace Member Typedefs</a></li><li class="dropdown-item"><!----> <a href="/wrenbind17/docs/doxygen/namespace_member_enums.html" class="nav-link">Namespace Member Enumerations</a></li></ul></div></div><div class="nav-item"><a href="/wrenbind17/docs/doxygen/files.html" class="nav-link">Files</a></div><div class="nav-item"><a href="/wrenbind17/docs/doxygen/pages.html" class="nav-link">Pages</a></div><div class="nav-item"><a href="/wrenbind17/docs/doxygen/bug.html" class="nav-link">Bugs</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/wrenbind17/" class="nav-link">Home</a></div><div class="nav-item"><a href="/wrenbind17/docs/tutorial.html" class="nav-link router-link-exact-active router-link-active">Tutorial</a></div><div class="nav-item"><a href="/wrenbind17/docs/doxygen/modules.html" class="nav-link">Modules</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Classes</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/wrenbind17/docs/doxygen/annotated.html" class="nav-link">Class List</a></li><li class="dropdown-item"><!----> <a href="/wrenbind17/docs/doxygen/classes.html" class="nav-link">Class Index</a></li><li class="dropdown-item"><!----> <a href="/wrenbind17/docs/doxygen/hierarchy.html" class="nav-link">Class Hierarchy</a></li><li class="dropdown-item"><!----> <a href="/wrenbind17/docs/doxygen/class_members.html" class="nav-link">Class Members</a></li><li class="dropdown-item"><!----> <a href="/wrenbind17/docs/doxygen/class_member_functions.html" class="nav-link">Class Member Functions</a></li><li class="dropdown-item"><!----> <a href="/wrenbind17/docs/doxygen/class_member_variables.html" class="nav-link">Class Member Variables</a></li><li class="dropdown-item"><!----> <a href="/wrenbind17/docs/doxygen/class_member_typedefs.html" class="nav-link">Class Member Typedefs</a></li><li class="dropdown-item"><!----> <a href="/wrenbind17/docs/doxygen/class_member_enums.html" class="nav-link">Class Member Enumerations</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Namespaces</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/wrenbind17/docs/doxygen/namespaces.html" class="nav-link">Namespace List</a></li><li class="dropdown-item"><!----> <a href="/wrenbind17/docs/doxygen/namespace_members.html" class="nav-link">Namespace Members</a></li><li class="dropdown-item"><!----> <a href="/wrenbind17/docs/doxygen/namespace_member_functions.html" class="nav-link">Namespace Member Functions</a></li><li class="dropdown-item"><!----> <a href="/wrenbind17/docs/doxygen/namespace_member_variables.html" class="nav-link">Namespace Member Variables</a></li><li class="dropdown-item"><!----> <a href="/wrenbind17/docs/doxygen/namespace_member_typedefs.html" class="nav-link">Namespace Member Typedefs</a></li><li class="dropdown-item"><!----> <a href="/wrenbind17/docs/doxygen/namespace_member_enums.html" class="nav-link">Namespace Member Enumerations</a></li></ul></div></div><div class="nav-item"><a href="/wrenbind17/docs/doxygen/files.html" class="nav-link">Files</a></div><div class="nav-item"><a href="/wrenbind17/docs/doxygen/pages.html" class="nav-link">Pages</a></div><div class="nav-item"><a href="/wrenbind17/docs/doxygen/bug.html" class="nav-link">Bugs</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Tutorial</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/wrenbind17/docs/tutorial.html#_0-installation" class="sidebar-link">0. Installation</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/wrenbind17/docs/tutorial.html#_1-hello-world" class="sidebar-link">1. Hello World</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/wrenbind17/docs/tutorial.html#_2-executing-code" class="sidebar-link">2. Executing code</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/wrenbind17/docs/tutorial.html#_3-exceptions" class="sidebar-link">3. Exceptions</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/wrenbind17/docs/tutorial.html#_4-binding-c-classes" class="sidebar-link">4. Binding C++ classes</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wrenbind17/docs/tutorial.html#_4-1-basics" class="sidebar-link">4.1. Basics</a></li><li class="sidebar-sub-header"><a href="/wrenbind17/docs/tutorial.html#_4-2-function-ambiguity" class="sidebar-link">4.2. Function ambiguity</a></li><li class="sidebar-sub-header"><a href="/wrenbind17/docs/tutorial.html#_4-3-static-functions" class="sidebar-link">4.3. Static functions</a></li></ul></li><li><a href="/wrenbind17/docs/tutorial.html#_5-bind-c-class-varialbles-and-properties" class="sidebar-link">5. Bind C++ class varialbles and properties</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wrenbind17/docs/tutorial.html#_5-1-as-variables" class="sidebar-link">5.1. As variables</a></li><li class="sidebar-sub-header"><a href="/wrenbind17/docs/tutorial.html#_5-2-as-properties" class="sidebar-link">5.2. As properties</a></li><li class="sidebar-sub-header"><a href="/wrenbind17/docs/tutorial.html#_5-3-result" class="sidebar-link">5.3. Result</a></li></ul></li><li><a href="/wrenbind17/docs/tutorial.html#_6-bind-c-class-read-only-variables" class="sidebar-link">6. Bind C++ class read only variables</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/wrenbind17/docs/tutorial.html#_7-bind-c-abstract-classes" class="sidebar-link">7. Bind C++ abstract classes</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/wrenbind17/docs/tutorial.html#_8-call-wren-function" class="sidebar-link">8. Call Wren function</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wrenbind17/docs/tutorial.html#_8-1-basics" class="sidebar-link">8.1. Basics</a></li><li class="sidebar-sub-header"><a href="/wrenbind17/docs/tutorial.html#_8-2-wren-functions-don-t-need-to-be-static" class="sidebar-link">8.2. Wren functions don't need to be static</a></li></ul></li><li><a href="/wrenbind17/docs/tutorial.html#_9-lifetime-of-objects-returned-by-wren" class="sidebar-link">9. Lifetime of objects returned by Wren</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wrenbind17/docs/tutorial.html#_9-1-return-global-variables" class="sidebar-link">9.1. Return global variables</a></li><li class="sidebar-sub-header"><a href="/wrenbind17/docs/tutorial.html#_9-2-return-local-variables" class="sidebar-link">9.2. Return local variables</a></li><li class="sidebar-sub-header"><a href="/wrenbind17/docs/tutorial.html#_9-3-using-std-shared-ptr" class="sidebar-link">9.3. Using std::shared_ptr</a></li><li class="sidebar-sub-header"><a href="/wrenbind17/docs/tutorial.html#_9-4-lifetime-of-objects-passed-to-c-functions" class="sidebar-link">9.4. Lifetime of objects passed to C++ functions</a></li><li class="sidebar-sub-header"><a href="/wrenbind17/docs/tutorial.html#_9-5-tl-dr" class="sidebar-link">9.5. TL;DR</a></li></ul></li><li><a href="/wrenbind17/docs/tutorial.html#_10-lifetime-of-objects-passed-into-wren" class="sidebar-link">10. Lifetime of objects passed into Wren</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/wrenbind17/docs/tutorial.html#_11-bind-c-class-methods-via-external-functions" class="sidebar-link">11. Bind C++ class methods via external functions</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/wrenbind17/docs/tutorial.html#_12-modularity-internal-build-in-modules" class="sidebar-link">12. Modularity: internal build-in modules</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/wrenbind17/docs/tutorial.html#_13-modularity-import-wren-files" class="sidebar-link">13. Modularity: import Wren files</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/wrenbind17/docs/tutorial.html#_14-inheritance-via-composition" class="sidebar-link">14. Inheritance via composition</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/wrenbind17/docs/tutorial.html#_15-using-callbacks-via-fn-new" class="sidebar-link">15. Using callbacks via Fn.new</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/wrenbind17/docs/tutorial.html#_16-upcasting" class="sidebar-link">16. Upcasting</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/wrenbind17/docs/tutorial.html#_17-lists" class="sidebar-link">17. Lists</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wrenbind17/docs/tutorial.html#_17-1-pre-made-stl-vector-and-list-bindings" class="sidebar-link">17.1 Pre-made STL vector and list bindings</a></li><li class="sidebar-sub-header"><a href="/wrenbind17/docs/tutorial.html#_17-2-custom-lists" class="sidebar-link">17.2. Custom lists</a></li><li class="sidebar-sub-header"><a href="/wrenbind17/docs/tutorial.html#_17-3-operator" class="sidebar-link">17.3. Operator []</a></li></ul></li><li><a href="/wrenbind17/docs/tutorial.html#_18-overload-operators" class="sidebar-link">18. Overload operators</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wrenbind17/docs/tutorial.html#_18-1-arithmetic-and-comparison-operators" class="sidebar-link">18.1. Arithmetic and comparison operators</a></li><li class="sidebar-sub-header"><a href="/wrenbind17/docs/tutorial.html#_18-2-operator-with-multiple-types" class="sidebar-link">18.2. Operator with multiple types</a></li></ul></li><li><a href="/wrenbind17/docs/tutorial.html#_19-using-std-variant" class="sidebar-link">19. Using std::variant</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/wrenbind17/docs/tutorial.html#_20-customize-vm-behavior" class="sidebar-link">20. Customize VM behavior</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="tutorial"><a href="#tutorial" aria-hidden="true" class="header-anchor">#</a> Tutorial</h1> <h2 id="_0-installation"><a href="#_0-installation" aria-hidden="true" class="header-anchor">#</a> 0. Installation</h2> <p>You don't need to compile this library. This library is a header only! All you have to do is to include the <code>#include &lt;wrenbind17/wrenbind17.hpp&gt;</code> header in your application.</p> <p>This library will also need an access to <code>&lt;wren.hpp&gt;</code> and you will also need to link the Wren library. To see how to build the Wren library, see <a href="http://wren.io/getting-started.html" target="_blank" rel="noopener noreferrer">Getting Started section here<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>Optionally, you can build wrenbind17 with Wren. To do this, simply clone this repository, and use CMake:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">git</span> clone https://github.com/matusnovak/wrenbind17.git
<span class="token builtin class-name">cd</span> wrenbind17
<span class="token function">mkdir</span> build
<span class="token builtin class-name">cd</span> build
cmake <span class="token punctuation">..</span> -DWRENBIND17_BUILD_WREN<span class="token operator">=</span>ON
cmake --build <span class="token builtin class-name">.</span>
</code></pre></div><h2 id="_1-hello-world"><a href="#_1-hello-world" aria-hidden="true" class="header-anchor">#</a> 1. Hello World</h2> <p>First, create a <code>wren::VM</code> instance, find the method you want to run, and execute the method. In the example below, we are printing out a simple &quot;Hello World&quot; to the console. It is recommended that you create an alias from <code>wrenbind17</code> to <code>wren</code> so you don't have to type that many characters every time. I highly encourage you to <strong>NOT</strong> to use <code>using namespace wrenbind17;</code>!</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;wrenbind17/wrenbind17.hpp&gt;</span></span>
<span class="token keyword">namespace</span> wren <span class="token operator">=</span> wrenbind17<span class="token punctuation">;</span> <span class="token comment">// Alias</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> std<span class="token operator">::</span>string code <span class="token operator">=</span> <span class="token raw-string string">R&quot;(
        class Main {
            static main() {
                System.print(&quot;Hello World!&quot;)
            }
        }
    )&quot;</span><span class="token punctuation">;</span>

    <span class="token comment">// Create new VM</span>
    wren<span class="token operator">::</span>VM vm<span class="token punctuation">;</span>

    <span class="token comment">// Runs the code from the std::string as a &quot;main&quot; module</span>
    vm<span class="token punctuation">.</span><span class="token function">runFromSource</span><span class="token punctuation">(</span><span class="token string">&quot;main&quot;</span><span class="token punctuation">,</span> code<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Find class Main in module main</span>
    wren<span class="token operator">::</span>Variable mainClass <span class="token operator">=</span> vm<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">&quot;main&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Main&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Find function main() in class Main</span>
    wren<span class="token operator">::</span>Method main <span class="token operator">=</span> mainClass<span class="token punctuation">.</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token string">&quot;main()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Execute the function</span>
    <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_2-executing-code"><a href="#_2-executing-code" aria-hidden="true" class="header-anchor">#</a> 2. Executing code</h2> <p>Executing Wren code can be done in the following ways:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token comment">// Execute from raw std::string and specify the module name manually.</span>
<span class="token comment">// Can be any module name you want!</span>
vm<span class="token punctuation">.</span><span class="token function">runFromSource</span><span class="token punctuation">(</span><span class="token string">&quot;main&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;var i = 42&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Same as above, specify the module name but instead</span>
<span class="token comment">// of the source code you tell it where the file is located.</span>
vm<span class="token punctuation">.</span><span class="token function">runFromFile</span><span class="token punctuation">(</span><span class="token string">&quot;main&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;path/to/some/main.wren&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Run specific module. This module must be an existing file &quot;utils/libB.wren&quot;</span>
<span class="token comment">// in one or more look-up paths specified during creation of wren::Vm vm(...);</span>
<span class="token comment">// Read through Modularity section(s) further down!</span>
vm<span class="token punctuation">.</span><span class="token function">runFromModule</span><span class="token punctuation">(</span><span class="token string">&quot;utils/libB&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_3-exceptions"><a href="#_3-exceptions" aria-hidden="true" class="header-anchor">#</a> 3. Exceptions</h2> <p>TODO</p> <h2 id="_4-binding-c-classes"><a href="#_4-binding-c-classes" aria-hidden="true" class="header-anchor">#</a> 4. Binding C++ classes</h2> <h3 id="_4-1-basics"><a href="#_4-1-basics" aria-hidden="true" class="header-anchor">#</a> 4.1. Basics</h3> <p>To bind a C++ class, you will first need to create a new module. Creating a new module is done per VM basis. If you have multiple VMs in your application, they won't share the same modules. You would have to create the module for each of your VM instances.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code>wren<span class="token operator">::</span>VM vm<span class="token punctuation">;</span>

<span class="token comment">// Create module called &quot;mymodule&quot;</span>
<span class="token keyword">auto</span><span class="token operator">&amp;</span> m <span class="token operator">=</span> vm<span class="token punctuation">.</span><span class="token function">module</span><span class="token punctuation">(</span><span class="token string">&quot;mymodule&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>You can create as many modules as you want. Additionally, calling the method <code>module(...)</code> multiple times with the same name won't create duplicates. For example:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code>wren<span class="token operator">::</span>VM vm<span class="token punctuation">;</span>

<span class="token keyword">auto</span><span class="token operator">&amp;</span> m0 <span class="token operator">=</span> vm<span class="token punctuation">.</span><span class="token function">module</span><span class="token punctuation">(</span><span class="token string">&quot;mymodule&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">auto</span><span class="token operator">&amp;</span> m1 <span class="token operator">=</span> vm<span class="token punctuation">.</span><span class="token function">module</span><span class="token punctuation">(</span><span class="token string">&quot;mymodule&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// m0 and m1 now point to the exact same module</span>
</code></pre></div><p>Classes are added into the modules in the following way:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>

    <span class="token keyword">int</span> <span class="token function">baz</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

wren<span class="token operator">::</span>VM vm<span class="token punctuation">;</span>
<span class="token keyword">auto</span><span class="token operator">&amp;</span> m <span class="token operator">=</span> vm<span class="token punctuation">.</span><span class="token function">module</span><span class="token punctuation">(</span><span class="token string">&quot;mymodule&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Add class &quot;Foo&quot;</span>
<span class="token keyword">auto</span><span class="token operator">&amp;</span> cls <span class="token operator">=</span> m<span class="token punctuation">.</span>klass<span class="token operator">&lt;</span>Foo<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;Foo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Define constructor (you can only specify one constructor)</span>
cls<span class="token punctuation">.</span>ctor<span class="token operator">&lt;</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Add some methods</span>
cls<span class="token punctuation">.</span>func<span class="token operator">&lt;</span><span class="token operator">&amp;</span>Foo<span class="token operator">::</span>bar<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;bar&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>func<span class="token operator">&lt;</span><span class="token operator">&amp;</span>Foo<span class="token operator">::</span>baz<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;baz&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="tip custom-block"><p>Note!</p> <p>The class functions (methods) are added as a template argument, not as the function argument. This is due to the how Wren is built. Because of this implementation, you will also get extra performance, because the pointers to the class functions are optimized at compile time.</p></div> <p>Now inside of your Wren script, you can do the following:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token string">&quot;mymodule&quot;</span> <span class="token keyword">for</span> Foo

<span class="token keyword">var</span> foo <span class="token operator">=</span> Foo<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">&quot;Message&quot;</span><span class="token punctuation">)</span>
</code></pre></div><p>Please note that you don't have to manually create file &quot;mymodule.wren&quot; and add all of your C++ foreign classes into it manually. Everything is automatically generated by the <code>wren::VM</code>. You can get the &quot;raw&quot; contents of the module that will be put into Wren by simply calling <code>.str()</code> on the module (e.g. <code>vm.module(&quot;mymodule&quot;).str();</code>).</p> <h3 id="_4-2-function-ambiguity"><a href="#_4-2-function-ambiguity" aria-hidden="true" class="header-anchor">#</a> 4.2. Function ambiguity</h3> <p>In case you have multiple functions with the same name, you will have to use <code>static_cast</code> to explicitly tell the compiler which function you want. For example:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> <span class="token function">getMsg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
    std<span class="token operator">::</span>string<span class="token operator">&amp;</span> <span class="token function">getMsg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

wren<span class="token operator">::</span>VM vm<span class="token punctuation">;</span>
<span class="token keyword">auto</span><span class="token operator">&amp;</span> m <span class="token operator">=</span> vm<span class="token punctuation">.</span><span class="token function">module</span><span class="token punctuation">(</span><span class="token string">&quot;mymodule&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">auto</span><span class="token operator">&amp;</span> cls <span class="token operator">=</span> vm<span class="token punctuation">.</span>klass<span class="token operator">&lt;</span>Foo<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;Foo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>func<span class="token operator">&lt;</span><span class="token keyword">static_cast</span><span class="token operator">&lt;</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Foo<span class="token operator">::</span>getMsg<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;getMsg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_4-3-static-functions"><a href="#_4-3-static-functions" aria-hidden="true" class="header-anchor">#</a> 4.3. Static functions</h3> <p>To add a static function, simply call the <code>funcStatic</code> instead of <code>func</code> as shown below:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Log</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">debug</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> text<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">error</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> text<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">info</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string<span class="token operator">&amp;</span> text<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

wren<span class="token operator">::</span>VM vm<span class="token punctuation">;</span>
<span class="token keyword">auto</span><span class="token operator">&amp;</span> m <span class="token operator">=</span> vm<span class="token punctuation">.</span><span class="token function">module</span><span class="token punctuation">(</span><span class="token string">&quot;mymodule&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">auto</span><span class="token operator">&amp;</span> cls <span class="token operator">=</span> m<span class="token punctuation">.</span>klass<span class="token operator">&lt;</span>Log<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;Log&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>funcStatic<span class="token operator">&lt;</span><span class="token operator">&amp;</span>Log<span class="token operator">::</span>debug<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;debug&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>funcStatic<span class="token operator">&lt;</span><span class="token operator">&amp;</span>Log<span class="token operator">::</span>error<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>funcStatic<span class="token operator">&lt;</span><span class="token operator">&amp;</span>Log<span class="token operator">::</span>info<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;info&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_5-bind-c-class-varialbles-and-properties"><a href="#_5-bind-c-class-varialbles-and-properties" aria-hidden="true" class="header-anchor">#</a> 5. Bind C++ class varialbles and properties</h2> <p>There are two ways how to add C++ class variables to Wren.</p> <h3 id="_5-1-as-variables"><a href="#_5-1-as-variables" aria-hidden="true" class="header-anchor">#</a> 5.1. As variables</h3> <p>One way is to have a field and simply bind it to the Wren:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">struct</span> <span class="token class-name">Vec3</span> <span class="token punctuation">{</span>
    <span class="token keyword">float</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">float</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">float</span> z <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

wren<span class="token operator">::</span>VM vm<span class="token punctuation">;</span>
<span class="token keyword">auto</span><span class="token operator">&amp;</span> m <span class="token operator">=</span> vm<span class="token punctuation">.</span><span class="token function">module</span><span class="token punctuation">(</span><span class="token string">&quot;mymodule&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Add class &quot;Vec3&quot;</span>
<span class="token keyword">auto</span><span class="token operator">&amp;</span> cls <span class="token operator">=</span> m<span class="token punctuation">.</span>klass<span class="token operator">&lt;</span>Vec3<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;Vec3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>ctor<span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>var<span class="token operator">&lt;</span><span class="token operator">&amp;</span>Vec3<span class="token operator">::</span>x<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;x&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>var<span class="token operator">&lt;</span><span class="token operator">&amp;</span>Vec3<span class="token operator">::</span>y<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;y&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>var<span class="token operator">&lt;</span><span class="token operator">&amp;</span>Vec3<span class="token operator">::</span>z<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_5-2-as-properties"><a href="#_5-2-as-properties" aria-hidden="true" class="header-anchor">#</a> 5.2. As properties</h3> <p>Another way is to have a getter and a setter and bind those to the Wren:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Vec3</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">float</span> <span class="token function">getX</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>     <span class="token punctuation">{</span> <span class="token keyword">return</span> x<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">setX</span><span class="token punctuation">(</span><span class="token keyword">float</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span> x <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">float</span> <span class="token function">getY</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>     <span class="token punctuation">{</span> <span class="token keyword">return</span> y<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">setY</span><span class="token punctuation">(</span><span class="token keyword">float</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span> y <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">float</span> <span class="token function">getZ</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span>     <span class="token punctuation">{</span> <span class="token keyword">return</span> z<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">setZ</span><span class="token punctuation">(</span><span class="token keyword">float</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span> z <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token keyword">private</span><span class="token operator">:</span>
    <span class="token keyword">float</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">float</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">float</span> z <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

wren<span class="token operator">::</span>VM vm<span class="token punctuation">;</span>
<span class="token keyword">auto</span><span class="token operator">&amp;</span> m <span class="token operator">=</span> vm<span class="token punctuation">.</span><span class="token function">module</span><span class="token punctuation">(</span><span class="token string">&quot;mymodule&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Add class &quot;Vec3&quot;</span>
<span class="token keyword">auto</span><span class="token operator">&amp;</span> cls <span class="token operator">=</span> m<span class="token punctuation">.</span>klass<span class="token operator">&lt;</span>Vec3<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;Vec3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>ctor<span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>prop<span class="token operator">&lt;</span><span class="token operator">&amp;</span>Vec3<span class="token operator">::</span>getX<span class="token punctuation">,</span> <span class="token operator">&amp;</span>Vec3<span class="token operator">::</span>setX<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;x&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>prop<span class="token operator">&lt;</span><span class="token operator">&amp;</span>Vec3<span class="token operator">::</span>getY<span class="token punctuation">,</span> <span class="token operator">&amp;</span>Vec3<span class="token operator">::</span>setY<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;y&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>prop<span class="token operator">&lt;</span><span class="token operator">&amp;</span>Vec3<span class="token operator">::</span>getZ<span class="token punctuation">,</span> <span class="token operator">&amp;</span>Vec3<span class="token operator">::</span>setZ<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_5-3-result"><a href="#_5-3-result" aria-hidden="true" class="header-anchor">#</a> 5.3. Result</h3> <p>Equivalent wren code for both using <code>.var&lt;&amp;field&gt;(&quot;name&quot;)</code> or <code>.prop&lt;&amp;getter, &amp;setter&gt;(&quot;name&quot;)</code>:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Autogenerated</span>
foreign <span class="token keyword">class</span> <span class="token class-name">Vec3</span> <span class="token punctuation">{</span>
    construct <span class="token keyword">new</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    
    foreign x
    foreign x<span class="token operator">=</span><span class="token punctuation">(</span>rhs<span class="token punctuation">)</span>

    foreign y
    foreign y<span class="token operator">=</span><span class="token punctuation">(</span>rhs<span class="token punctuation">)</span>

    foreign z
    foreign z<span class="token operator">=</span><span class="token punctuation">(</span>rhs<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>And then simply use it in Wren as:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token string">&quot;mymodule&quot;</span> <span class="token keyword">for</span> Vec3

<span class="token keyword">var</span> v <span class="token operator">=</span> Vec3<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
v<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">1.23</span>
v<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token number">0.0</span>
v<span class="token punctuation">.</span>z <span class="token operator">=</span> <span class="token number">42.42</span>
</code></pre></div><h2 id="_6-bind-c-class-read-only-variables"><a href="#_6-bind-c-class-read-only-variables" aria-hidden="true" class="header-anchor">#</a> 6. Bind C++ class read only variables</h2> <p>To bind read-only variables you can use <code>varReadonly</code> function. This won't define a Wren setter and therefore the variable can be only read.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Vec3</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Vec3</span><span class="token punctuation">(</span><span class="token keyword">float</span> x<span class="token punctuation">,</span> <span class="token keyword">float</span> y<span class="token punctuation">,</span> <span class="token keyword">float</span> z<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span>

    <span class="token keyword">const</span> <span class="token keyword">float</span> x<span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token keyword">float</span> y<span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token keyword">float</span> z<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

wren<span class="token operator">::</span>VM vm<span class="token punctuation">;</span>
<span class="token keyword">auto</span><span class="token operator">&amp;</span> m <span class="token operator">=</span> vm<span class="token punctuation">.</span><span class="token function">module</span><span class="token punctuation">(</span><span class="token string">&quot;mymodule&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Add class &quot;Vec3&quot;</span>
<span class="token keyword">auto</span><span class="token operator">&amp;</span> cls <span class="token operator">=</span> m<span class="token punctuation">.</span>klass<span class="token operator">&lt;</span>Vec3<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;Vec3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>ctor<span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>varReadonly<span class="token operator">&lt;</span><span class="token operator">&amp;</span>Vec3<span class="token operator">::</span>x<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;x&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>varReadonly<span class="token operator">&lt;</span><span class="token operator">&amp;</span>Vec3<span class="token operator">::</span>y<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;y&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>varReadonly<span class="token operator">&lt;</span><span class="token operator">&amp;</span>Vec3<span class="token operator">::</span>z<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Equivalent wren code:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Autogenerated</span>
foreign <span class="token keyword">class</span> <span class="token class-name">Vec3</span> <span class="token punctuation">{</span>
    construct <span class="token keyword">new</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    
    foreign x

    foreign y

    foreign z
<span class="token punctuation">}</span>
</code></pre></div><p>And then simply use it in Wren as:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token string">&quot;mymodule&quot;</span> <span class="token keyword">for</span> Vec3

<span class="token keyword">var</span> v <span class="token operator">=</span> Vec3<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">1.1</span><span class="token punctuation">,</span> <span class="token number">2.3</span><span class="token punctuation">,</span> <span class="token number">3.3</span><span class="token punctuation">)</span>
System<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;X value is: %(v.x)&quot;</span><span class="token punctuation">)</span> <span class="token comment">// ok</span>
v<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">1.23</span> <span class="token comment">// error</span>
</code></pre></div><p>For read-only properties, you can use <code>propReadonly</code> as shown below:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token comment">// Add class &quot;Vec3&quot;</span>
<span class="token keyword">auto</span><span class="token operator">&amp;</span> cls <span class="token operator">=</span> m<span class="token punctuation">.</span>klass<span class="token operator">&lt;</span>Vec3<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;Vec3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>ctor<span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>propReadonly<span class="token operator">&lt;</span><span class="token operator">&amp;</span>Vec3<span class="token operator">::</span>getX<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;x&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>propReadonly<span class="token operator">&lt;</span><span class="token operator">&amp;</span>Vec3<span class="token operator">::</span>getY<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;y&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>propReadonly<span class="token operator">&lt;</span><span class="token operator">&amp;</span>Vec3<span class="token operator">::</span>getZ<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_7-bind-c-abstract-classes"><a href="#_7-bind-c-abstract-classes" aria-hidden="true" class="header-anchor">#</a> 7. Bind C++ abstract classes</h2> <p>What if you want to pass an abstract class to Wren? You can't allocate it. You can only pass it around. Imagine a specific derived &quot;Entity&quot; class that has a common abstract/interface class?</p> <p>The only thing you have to do is to NOT do add <code>ctor</code></p> <div class="language-cpp extra-class"><pre class="language-cpp"><code>wren<span class="token operator">::</span>VM vm<span class="token punctuation">;</span>
<span class="token keyword">auto</span><span class="token operator">&amp;</span> m <span class="token operator">=</span> vm<span class="token punctuation">.</span><span class="token function">module</span><span class="token punctuation">(</span><span class="token string">&quot;mymodule&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Add class &quot;Vec3&quot;</span>
<span class="token keyword">auto</span><span class="token operator">&amp;</span> cls <span class="token operator">=</span> m<span class="token punctuation">.</span>klass<span class="token operator">&lt;</span>Entity<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;Entity&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// cls.ctor&lt;&gt;(); Do not add constructor!</span>
cls<span class="token punctuation">.</span>func<span class="token operator">&lt;</span><span class="token operator">&amp;</span>Entity<span class="token operator">::</span>foo<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;foo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_8-call-wren-function"><a href="#_8-call-wren-function" aria-hidden="true" class="header-anchor">#</a> 8. Call Wren function</h2> <h3 id="_8-1-basics"><a href="#_8-1-basics" aria-hidden="true" class="header-anchor">#</a> 8.1. Basics</h3> <p>In order to call Wren functions, you will need to define those functions in a Wren class. The most common way to do that is to declare the function as static:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> a <span class="token operator">+</span> b
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>To find the function, you will first need to compile the source, and only then look for the specific class. When you get the class, you can find the any specific function inside of that class. To execute the function, call the <code>operator()(Args&amp;&amp;... args)</code> method on <code>wren::Method</code>.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code>wren<span class="token operator">::</span>VM vm<span class="token punctuation">;</span>

<span class="token comment">// Runs the code as a specific &quot;somemodule&quot; module.</span>
vm<span class="token punctuation">.</span><span class="token function">runFromSource</span><span class="token punctuation">(</span><span class="token string">&quot;somemodule&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;...code from above...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Find the class</span>
wren<span class="token operator">::</span>Variable wrenClass <span class="token operator">=</span> vm<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">&quot;somemodule&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Main&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Find the function with two arguments</span>
wren<span class="token operator">::</span>Method wrenMethod <span class="token operator">=</span> wrenClass<span class="token punctuation">.</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token string">&quot;main(_, _)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Call the function with two integers</span>
wren<span class="token operator">::</span>Any result <span class="token operator">=</span> <span class="token function">wrenMethod</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Check if the result is some specific C++ type</span>
result<span class="token punctuation">.</span>is<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>

<span class="token comment">// Cast the result to C++ type</span>
<span class="token keyword">int</span> sum <span class="token operator">=</span> result<span class="token punctuation">.</span>as<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 15</span>
</code></pre></div><div class="warning custom-block"><p>Warning!</p> <p>The lifetime of the object returned by calling Wren methods is determined by the wren::Any. If you return an instance of a class from Wren to C++, and you capture that result as a pointer/reference to the class (i.e. <code>result.as&lt;Foo*&gt;()</code> or <code>result.as&lt;Foo&amp;&gt;()</code>) then the lifetime of that pointer or reference will depend on the lifetime of wren::Any and how is the class instantiated on Wren (did you return a local variable or a global variable?). Read more in the next section 6.</p></div> <h3 id="_8-2-wren-functions-don-t-need-to-be-static"><a href="#_8-2-wren-functions-don-t-need-to-be-static" aria-hidden="true" class="header-anchor">#</a> 8.2. Wren functions don't need to be static</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
    construct <span class="token keyword">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>

    <span class="token function">main</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> a <span class="token operator">+</span> b
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> Instance <span class="token operator">=</span> Main<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>And then in C++:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token comment">// Find the class</span>
wren<span class="token operator">::</span>Variable wrenClass <span class="token operator">=</span> vm<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">&quot;somemodule&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Instance&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Find the function with two arguments</span>
wren<span class="token operator">::</span>Method wrenMethod <span class="token operator">=</span> wrenClass<span class="token punctuation">.</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token string">&quot;main(_, _)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_9-lifetime-of-objects-returned-by-wren"><a href="#_9-lifetime-of-objects-returned-by-wren" aria-hidden="true" class="header-anchor">#</a> 9. Lifetime of objects returned by Wren</h2> <h3 id="_9-1-return-global-variables"><a href="#_9-1-return-global-variables" aria-hidden="true" class="header-anchor">#</a> 9.1. Return global variables</h3> <p>Suppose you have created an instance of a C++ class in Wren as a global variable:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token string">&quot;mymodule&quot;</span> <span class="token keyword">for</span> Foo

<span class="token comment">// Starts with capital letter so we can access it inside</span>
<span class="token comment">// functions and classes</span>
<span class="token keyword">var</span> Instance <span class="token operator">=</span> Foo<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> Instance
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Then if you access the instance via C++:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">auto</span><span class="token operator">&amp;</span> main <span class="token operator">=</span> vm<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">&quot;main&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Main&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token string">&quot;main()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
wren<span class="token operator">::</span>Any result <span class="token operator">=</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Foo cpy <span class="token operator">=</span> result<span class="token punctuation">.</span>as<span class="token operator">&lt;</span>Foo<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// cpy is now a copy of Wren's Foo instance.</span>
<span class="token comment">// The lifetime of cpy or &quot;Instance&quot; is not modified.</span>
</code></pre></div><p>Then nothing much happens because you are creating a copy of Foo. But what if you access it by a pointer?</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">auto</span><span class="token operator">&amp;</span> main <span class="token operator">=</span> vm<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">&quot;main&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Main&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token string">&quot;main()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
wren<span class="token operator">::</span>Any result <span class="token operator">=</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Foo<span class="token operator">*</span> ptr <span class="token operator">=</span> result<span class="token punctuation">.</span>as<span class="token operator">&lt;</span>Foo<span class="token operator">*</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ptr points to the same instance as Wren's &quot;Instance&quot; var.</span>

<span class="token comment">// Using this pointer is OK because the instance will be alive</span>
<span class="token comment">// until the Wren VM shuts down.</span>
ptr<span class="token operator">-&gt;</span><span class="token function">someMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">delete</span> ptr<span class="token punctuation">;</span> <span class="token comment">// Segmentation fault, memory is managed by Wren!</span>
</code></pre></div><p>Then you have a pointer to the same instance, but when will it get free? Only when Wren VM gets shut doen (VM gets deleted, falls out of the scope, etc). So the pointer you get is valid as long as the VM is alive. <strong>After that, it will get deleted by Wren, so don't free it manually!</strong></p> <h3 id="_9-2-return-local-variables"><a href="#_9-2-return-local-variables" aria-hidden="true" class="header-anchor">#</a> 9.2. Return local variables</h3> <p>But what about returning local variables?</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token string">&quot;mymodule&quot;</span> <span class="token keyword">for</span> Foo

<span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> Foo<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Then if you access the instance via C++:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">auto</span><span class="token operator">&amp;</span> main <span class="token operator">=</span> vm<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">&quot;main&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Main&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token string">&quot;main()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Foo<span class="token operator">*</span> ptr <span class="token operator">=</span> null<span class="token punctuation">;</span>

<span class="token punctuation">{</span> <span class="token comment">// Inside of some scope</span>
    wren<span class="token operator">::</span>Any result <span class="token operator">=</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ptr <span class="token operator">=</span> result<span class="token punctuation">.</span>as<span class="token operator">&lt;</span>Foo<span class="token operator">*</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ptr<span class="token operator">-&gt;</span><span class="token function">someMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// OK</span>
<span class="token punctuation">}</span>

<span class="token comment">// At this point, the result (wren::Any)</span>
<span class="token comment">// has been destroyed because it has fallen out of the scope</span>

ptr<span class="token operator">-&gt;</span><span class="token function">someMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Undefined bahvior</span>
</code></pre></div><p>The Wren language is garbage collected. Therefore once the variable is out of the scope, it may or may not be destroyed. It depends on the implementation of the language. But! <strong>The wren::Any will extend the lifetime of the object</strong> so you can use the pointer as long as the result is alive.</p> <h3 id="_9-3-using-std-shared-ptr"><a href="#_9-3-using-std-shared-ptr" aria-hidden="true" class="header-anchor">#</a> 9.3. Using std::shared_ptr</h3> <p>One way to avoid these bad scenarios is to use modern C++11 features! If you use this:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">auto</span><span class="token operator">&amp;</span> main <span class="token operator">=</span> vm<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">&quot;main&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Main&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token string">&quot;main()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


wren<span class="token operator">::</span>Any result <span class="token operator">=</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
std<span class="token operator">::</span>shared_ptr<span class="token operator">&lt;</span>Foo<span class="token operator">&gt;</span> ptr <span class="token operator">=</span> result<span class="token punctuation">.</span>shared<span class="token operator">&lt;</span>Foo<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ptr<span class="token operator">-&gt;</span><span class="token function">someMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// OK</span>
</code></pre></div><p>So now you have extended the lifetime of the Foo instance by using a shared pointer. This shared pointer points to the exact same instance as the internal implementation of this library. The instances are passed around as a shared pointer (even if you pass it as a raw pointer), so the Foo will be alive even after the Wren VM has shut down. The memory will be managed by both C++ and Wren, because all C++ class instances are shared pointers.</p> <p>If it is still confusing, then you can think of it as:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token comment">// Let's think of this as wren::Any (result of a function call)</span>
std<span class="token operator">::</span>shared_ptr<span class="token operator">&lt;</span>Foo<span class="token operator">&gt;</span> result<span class="token punctuation">;</span>

Foo<span class="token operator">*</span> ptr <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Obviously dangerous</span>
std<span class="token operator">::</span>shared_ptr<span class="token operator">&lt;</span>Foo<span class="token operator">&gt;</span> ptr <span class="token operator">=</span> result<span class="token punctuation">;</span> <span class="token comment">// Safe</span>
</code></pre></div><div class="warning custom-block"><p>Warning!</p> <p>This is all OK until your Foo instance from above will use some additional Wren variables. If it is just a plain C++ class and you have only created it on the Wren side, then you have nothing to worry about. If your C++ class contains some other Wren instances, then it really depends on your own implementation of your application.</p></div> <h3 id="_9-4-lifetime-of-objects-passed-to-c-functions"><a href="#_9-4-lifetime-of-objects-passed-to-c-functions" aria-hidden="true" class="header-anchor">#</a> 9.4. Lifetime of objects passed to C++ functions</h3> <p>So how does all of the above behave on C++ functions? Suppose we have the following:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span>
    <span class="token comment">// Danger! We will get an instance of local</span>
    <span class="token comment">// Foo variable from Wren. This pointer may be invalid </span>
    <span class="token comment">// once you exit this function! The pointer will be </span>
    <span class="token comment">// valid only during the execution of this function body.</span>
    <span class="token keyword">void</span> <span class="token function">setParent</span><span class="token punctuation">(</span>Foo<span class="token operator">*</span> other<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>And then inside of Wren code:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token parameter">child</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        child<span class="token punctuation">.</span><span class="token function">setParent</span><span class="token punctuation">(</span>Foo<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>It will behave exactly same as returning a variable from calling Wren function! The pointer will point to the local Wren instance that may be garbage collected almost right after the call has been made. Don't pass instances like that. Either make the instance a global Wren variable or use smart pointers as shown below:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span>
    <span class="token comment">// Much better and it's safe!</span>
    <span class="token keyword">void</span> <span class="token function">setParent</span><span class="token punctuation">(</span>std<span class="token operator">::</span>shared_ptr<span class="token operator">&lt;</span>Foo<span class="token operator">&gt;</span> other<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>And then inside of Wren code:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token parameter">child</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        child<span class="token punctuation">.</span><span class="token function">setParent</span><span class="token punctuation">(</span>Foo<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_9-5-tl-dr"><a href="#_9-5-tl-dr" aria-hidden="true" class="header-anchor">#</a> 9.5. TL;DR</h3> <ul><li>Getting <code>Foo</code> from Wren is OK.</li> <li>Getting <code>Foo*</code> from Wren is OK as long as the variable in Wren is global. (Or you somehow ensure that you use the dangling pointer on C++ safely, for example using it only inside of the C++ function being called).</li> <li>Getting <code>Foo&amp;</code> from Wren is same as <code>Foo*</code>.</li> <li>Getting <code>std::shared_ptr&lt;Foo&gt;</code> is always safe.</li></ul> <h2 id="_10-lifetime-of-objects-passed-into-wren"><a href="#_10-lifetime-of-objects-passed-into-wren" aria-hidden="true" class="header-anchor">#</a> 10. Lifetime of objects passed into Wren</h2> <p>In the previous section we have discussed what happens with objects that are returned from Wren, but what about the other way around?</p> <p>It's very simple in this case. There are only 4 different scenarios:</p> <ul><li>Pass class <code>Foo</code> as a value. The Wren will create a copy of it.</li> <li>Pass class <code>Foo*</code> as a pointer. The instance will be wrapped into <code>std::shared_ptr&lt;Foo&gt;</code> <strong>but won't free it</strong>. So it will be alive inside of Wren until you free the instance on C++ side. Wren's garbage collector won't free this instance.</li> <li>Pass class <code>Foo&amp;</code> as a reference. This is the same case as passing a pointer.</li> <li>Pass class <code>std::shared_ptr&lt;Foo&gt;</code> as a shared pointer. The lifetime of this object will be extended by Wren. So both C++ and Wren will manage the lifetime of this. If you lose the shared pointer on C++ side, and Wren holds the instance, then it will be freed by Wren's garbage collector only when the instance inside of Wren gets no longer used/referenced.</li></ul> <h2 id="_11-bind-c-class-methods-via-external-functions"><a href="#_11-bind-c-class-methods-via-external-functions" aria-hidden="true" class="header-anchor">#</a> 11. Bind C++ class methods via external functions</h2> <p>Suppose you have some C++ class you want to bind to Wren, but you can't modify this class because it is from some other library, for example from STL. You want to add some custom behavior but such C++ method does not exist. In this case, you can do the following:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> T<span class="token operator">&gt;</span>
<span class="token keyword">bool</span> <span class="token function">vectorContains</span><span class="token punctuation">(</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span><span class="token operator">&amp;</span> self<span class="token punctuation">,</span> <span class="token keyword">const</span> T<span class="token operator">&amp;</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> std<span class="token operator">::</span><span class="token function">find</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span> <span class="token operator">!=</span> self<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">auto</span><span class="token operator">&amp;</span> cls <span class="token operator">=</span> m<span class="token punctuation">.</span>klass<span class="token operator">&lt;</span>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;VectorInt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>ctor<span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>funcExt<span class="token operator">&lt;</span><span class="token operator">&amp;</span>contains<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;contains&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token string">&quot;mymodule&quot;</span> <span class="token keyword">for</span> VectorInt

<span class="token keyword">var</span> v <span class="token operator">=</span> VectorInt<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
v<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span> <span class="token comment">// returns bool</span>
</code></pre></div><p>&quot;Ext&quot; simply means that this is an external function, and the first parameter <strong>must</strong> accept a reference to the class you are binding. Look at the <code>vectorContains</code> function from above, there is no &quot;this&quot; pointer because this is not a member function, instead &quot;this&quot; is provided as a custom first parameter. This also works with <code>propExt</code> and <code>propReadonlyExt</code>.</p> <h2 id="_12-modularity-internal-build-in-modules"><a href="#_12-modularity-internal-build-in-modules" aria-hidden="true" class="header-anchor">#</a> 12. Modularity: internal build-in modules</h2> <p>Modules can be created in the following way:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code>wren<span class="token operator">::</span>VM vm<span class="token punctuation">;</span>
<span class="token keyword">auto</span><span class="token operator">&amp;</span> m <span class="token operator">=</span> vm<span class="token punctuation">.</span><span class="token function">module</span><span class="token punctuation">(</span><span class="token string">&quot;mymodule&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">auto</span><span class="token operator">&amp;</span> cls <span class="token operator">=</span> m<span class="token punctuation">.</span>klass<span class="token operator">&lt;</span>Entity<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;Entity&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>func<span class="token operator">&lt;</span><span class="token operator">&amp;</span>Entity<span class="token operator">::</span>foo<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;foo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre></div><p>But, you are also able to create your own &quot;raw&quot; modules.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code>wren<span class="token operator">::</span>VM vm<span class="token punctuation">;</span>
<span class="token keyword">auto</span><span class="token operator">&amp;</span> m <span class="token operator">=</span> vm<span class="token punctuation">.</span><span class="token function">module</span><span class="token punctuation">(</span><span class="token string">&quot;mymodule&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

m<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token raw-string string">R&quot;(
    class Vec3 {
        construct new (x, y, z) {
            ...
        }
    }
)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Anything you add via <code>m.append(...)</code> will be loaded into Wren when you import that module. Anything you put inside of <code>append(...)</code> will always be appended at the end of the module. Meaning, if you bind some C++ classes, the raw string(s) you append to that module will always be after the C++ classes. You can append as much code as you want, until you run out of system memory.</p> <p>These modules can be loaded in Wren by calling:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token string">&quot;mymodule&quot;</span> <span class="token keyword">for</span> Foo<span class="token punctuation">,</span> Vec3
</code></pre></div><div class="tip custom-block"><p>Note!</p> <p>You can use <code>mymodule/something</code> as a built in module names. Slashes are allowed.</p></div> <h2 id="_13-modularity-import-wren-files"><a href="#_13-modularity-import-wren-files" aria-hidden="true" class="header-anchor">#</a> 13. Modularity: import Wren files</h2> <p>Other source code files can be imported into Wren. But this depends on the lookup paths. When creating an instance of the VM, the first argument is a list of paths to use for lookup. Example below:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code>std<span class="token operator">::</span>vector<span class="token operator">&lt;</span>std<span class="token operator">::</span>string<span class="token operator">&gt;</span> paths <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;some/relative/path&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;C:/absolute/path&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
wren<span class="token operator">::</span>VM <span class="token function">vm</span><span class="token punctuation">(</span>paths<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="warning custom-block"><p>Warning!</p> <p>The default value of the VM constructor is <code>{&quot;./&quot;}</code>. This means that by default the VM will look for files relative to your working directory! If there is a file <code>libs/mylib.wren</code> in your working directory, and in Wren you load it as <code>import &quot;libs/mylib&quot; for XYZ</code> then it will load it from your working directory as <code>&quot;your_working_dir&quot; + &quot;./&quot; + &quot;libs/mylib.wren&quot;</code>.</p></div> <p>So how does the lookup paths work? Consider the following example:</p> <div class="language- extra-class"><pre class="language-text"><code>myprogram/
    app.exe
    data/
        main.wren
        libA.wren
        utils/
            libB.wren
</code></pre></div><p>So you have three files: <code>data/main.wren</code>, <code>data/libA.wren</code>, and <code>data/utils/libB.wren</code>. Now, inside of your main you might have something like this:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// File: data/main.wren</span>

<span class="token keyword">import</span> <span class="token string">&quot;libA&quot;</span> <span class="token keyword">for</span> <span class="token constant">XYZ</span>
<span class="token comment">// Won't work because &quot;libA.wren&quot; does not exist in &quot;./&quot;</span>
</code></pre></div><p>And let's assume you are running <code>app.exe</code> with working directory of <code>myprogram/</code>. The above code will fail. Why? Because the default argument for <code>wren::VM</code> paths is <code>{&quot;./&quot;}</code>. Meaning, it will look for <code>libA.wren</code> relatively to <code>./</code> which is relative to your working directory.</p> <div class="warning custom-block"><p>Relative imports do not work due to the design of Wren! Absolute imports are the only way!</p></div> <p>What you need to do is to put an absolute path to <code>myprogram/data</code> into your <code>wren::VM vm({&quot;C:/whatever/apps/myprogram/data&quot;});</code>. So only then the import will work. The import system works in a way that it will append the import string into your lookup paths and checks wether the file exists. If yes, it will load it.</p> <p>What about importing <code>utils/libB.wren</code>? The following will work:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// File: data/libA.wren</span>

<span class="token keyword">import</span> <span class="token string">&quot;utils/libB&quot;</span> <span class="token keyword">for</span> <span class="token constant">XYZ</span>
<span class="token comment">// looks for &quot;C:/whatever/apps/myprogram/data/&quot; + &quot;utils/libB.wren&quot;</span>
</code></pre></div><p>Imports from a parent folder work too, because everything is absolute path anyway.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// File: data/utils/libB.wren</span>

<span class="token keyword">import</span> <span class="token string">&quot;libA&quot;</span> <span class="token keyword">for</span> <span class="token constant">XYZ</span> 
<span class="token comment">// looks for &quot;C:/whatever/apps/myprogram/data/&quot; + &quot;libA.wren&quot;</span>
</code></pre></div><h2 id="_14-inheritance-via-composition"><a href="#_14-inheritance-via-composition" aria-hidden="true" class="header-anchor">#</a> 14. Inheritance via composition</h2> <p>Wren does not support inheritacne of foreign classes. But, there is a workaround. Consider the following C++ class:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Entity</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>
    <span class="token keyword">virtual</span> <span class="token operator">~</span><span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>

    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>Now we want to have our own class in Wren:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token string">&quot;game&quot;</span> <span class="token keyword">for</span> Entity

<span class="token keyword">class</span> <span class="token class-name">Enemy</span> is Entity <span class="token punctuation">{</span> <span class="token comment">// Not allowed by Wren :(</span>
    construct <span class="token keyword">new</span> <span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>

    <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Do something specific for Entity class</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>But this does not work. You can't inherit from foreign classes. But, don't lose hope yet, there is a workaround. First, we need to create a C++ derived class of the base abstract class that overrides the update method.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">WrenEntity</span><span class="token operator">:</span> <span class="token keyword">public</span> Entity <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token comment">// Pass the Wren class to the constructor</span>
    <span class="token function">WrenEntity</span><span class="token punctuation">(</span>wren<span class="token operator">::</span>Variable derived<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Find all of the methods you want to &quot;override&quot;</span>
        <span class="token comment">// The number of arguments (_) or (_, _) does matter!</span>
        updateFn <span class="token operator">=</span> derived<span class="token punctuation">.</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token string">&quot;update(_)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">virtual</span> <span class="token operator">~</span><span class="token function">WrenEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>

    <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> override <span class="token punctuation">{</span>
        <span class="token comment">// Call the overriden Wren methods from</span>
        <span class="token comment">// the Wren class whenever you need to.</span>
        <span class="token comment">// Pass this class as the base class</span>
        <span class="token function">updateFn</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token keyword">private</span><span class="token operator">:</span>
    <span class="token comment">// Store the Wren methods as class fields</span>
    wren<span class="token operator">::</span>Method updateFn<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

wren<span class="token operator">::</span>VM vm<span class="token punctuation">;</span>
<span class="token keyword">auto</span><span class="token operator">&amp;</span> m <span class="token operator">=</span> vm<span class="token punctuation">.</span><span class="token function">module</span><span class="token punctuation">(</span><span class="token string">&quot;game&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">auto</span><span class="token operator">&amp;</span> cls <span class="token operator">=</span> m<span class="token punctuation">.</span>klass<span class="token operator">&lt;</span>WrenEntity<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;Entity&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>ctor<span class="token operator">&lt;</span>wren<span class="token operator">::</span>Variable<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

vm<span class="token punctuation">.</span><span class="token function">runFromSource</span><span class="token punctuation">(</span><span class="token string">&quot;main&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Call the main function (see Wren code below)</span>
<span class="token keyword">auto</span> res <span class="token operator">=</span> vm<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">&quot;main&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Main&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token string">&quot;main()&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Get the instance with Wren's specific functions</span>
std<span class="token operator">::</span>shared_ptr<span class="token operator">&lt;</span>WrenEntity<span class="token operator">&gt;</span> enemy <span class="token operator">=</span> res<span class="token punctuation">.</span>shared<span class="token operator">&lt;</span>WrenEntity<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>And the following Wren code to be used with the code above:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token string">&quot;game&quot;</span> <span class="token keyword">for</span> Entity

<span class="token keyword">class</span> <span class="token class-name">Enemy</span> <span class="token punctuation">{</span>
    <span class="token function">update</span> <span class="token punctuation">(</span><span class="token parameter">self</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// self points to the base class!</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token function">main</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Pass our custom Enemy class</span>
        <span class="token comment">// to the base Entity class into the constructor.</span>
        <span class="token comment">// The base class will call the necessary functions.</span>
        <span class="token keyword">return</span> Entity<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span>Enemy<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>With the example from above, if the methods are missing in the Wren's <code>Enemy</code> class, it will simply throw an exception, because <code>derived.find(signature)</code> throws <code>wren::NotFound</code> exception if not found.</p> <h2 id="_15-using-callbacks-via-fn-new"><a href="#_15-using-callbacks-via-fn-new" aria-hidden="true" class="header-anchor">#</a> 15. Using callbacks via Fn.new</h2> <p>Let's say you have a GUI button widget and you want to have a specific action when a user clicks on it.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">GuiButton</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">GuiButton</span><span class="token punctuation">(</span>std<span class="token operator">::</span>function<span class="token operator">&lt;</span><span class="token keyword">bool</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> func<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">func</span><span class="token punctuation">(</span>std<span class="token operator">::</span><span class="token function">move</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">virtual</span> <span class="token operator">~</span><span class="token function">GuiButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">bool</span> <span class="token function">event</span><span class="token punctuation">(</span><span class="token keyword">int</span> type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">func</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token keyword">private</span><span class="token operator">:</span>
    std<span class="token operator">::</span>function<span class="token operator">&lt;</span><span class="token keyword">bool</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> func<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>And now you would like to create this class in Wren and add some custom Wren function as the callback. What you can do is to create a Wren specific wrapper and accept a class instance (in this case, <code>Fn</code> class instance from Wren).</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">WrenGuiButton</span><span class="token operator">:</span> <span class="token keyword">public</span> GuiButton <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">WrenGuiButton</span><span class="token punctuation">(</span>wren<span class="token operator">::</span>Variable fn<span class="token punctuation">)</span> 
      <span class="token operator">:</span> <span class="token function">GuiButton</span><span class="token punctuation">(</span>std<span class="token operator">::</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>WrenGuiButton<span class="token operator">::</span>wrenEvent<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">,</span> std<span class="token operator">::</span>placeholders<span class="token operator">::</span>_1<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        callback <span class="token operator">=</span> fn<span class="token punctuation">.</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token string">&quot;call(_)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token keyword">private</span><span class="token operator">:</span>
    <span class="token keyword">bool</span> <span class="token function">wrenEvent</span><span class="token punctuation">(</span><span class="token keyword">int</span> type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">callback</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">.</span>as<span class="token operator">&lt;</span><span class="token keyword">bool</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    wren<span class="token operator">::</span>Method callback<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>Or using lambdas:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">WrenGuiButton</span><span class="token operator">:</span> <span class="token keyword">public</span> GuiButton <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">WrenGuiButton</span><span class="token punctuation">(</span>wren<span class="token operator">::</span>Variable fn<span class="token punctuation">)</span> 
      <span class="token operator">:</span> <span class="token function">GuiButton</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">int</span> type<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token keyword">bool</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">callback</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">.</span>as<span class="token operator">&lt;</span><span class="token keyword">bool</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        callback <span class="token operator">=</span> fn<span class="token punctuation">.</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token string">&quot;call(_)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token keyword">private</span><span class="token operator">:</span>
    wren<span class="token operator">::</span>Method callback<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>And then bind the class in the following way:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code>wren<span class="token operator">::</span>VM vm<span class="token punctuation">;</span>
<span class="token keyword">auto</span><span class="token operator">&amp;</span> m <span class="token operator">=</span> vm<span class="token punctuation">.</span><span class="token function">module</span><span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">auto</span><span class="token operator">&amp;</span> cls <span class="token operator">=</span> m<span class="token punctuation">.</span>klass<span class="token operator">&lt;</span>WrenGuiButton<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;GuiButton&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>ctor<span class="token operator">&lt;</span>wren<span class="token operator">::</span>Variable<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>And you can use it in the following way:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token string">&quot;test&quot;</span> <span class="token keyword">for</span> GuiButton

<span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> btn <span class="token operator">=</span> GuiButton<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span>Fn<span class="token punctuation">.</span>new <span class="token punctuation">{</span> <span class="token operator">|</span>arg<span class="token operator">|</span>
            <span class="token comment">// &quot;this&quot; is going to be &quot;Main&quot; class</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> btn
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>This works because Wren's <code>Fn.new{}</code> is actually an instance of a class, and executing the method is simple as calling <code>call(...)</code> of that instance.</p> <h2 id="_16-upcasting"><a href="#_16-upcasting" aria-hidden="true" class="header-anchor">#</a> 16. Upcasting</h2> <p>Upcasting is when you have a derived class <code>Enemy</code> and you would like to upcast it to <code>Entity</code>. An <code>Enemy</code> class is an <code>Entity</code>, but not the other way around. Remember, upcasting is getting the base class!</p> <p>But this might be a problem when for example, you create a derived class inside of Wren and you pass it into some C++ function that accepts the base class. What you have to do is to tell Wren what base classes it can be upcasted to. Consider the following example:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Entity</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Enemy</span><span class="token operator">:</span> <span class="token keyword">public</span> Entity <span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">EntityManager</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span>std<span class="token operator">::</span>shared_ptr<span class="token operator">&lt;</span>Entity<span class="token operator">&gt;</span> entity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        entities<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>entity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

Wren<span class="token operator">::</span>VM vm<span class="token punctuation">;</span>
<span class="token keyword">auto</span><span class="token operator">&amp;</span> m <span class="token operator">=</span> vm<span class="token punctuation">.</span><span class="token function">module</span><span class="token punctuation">(</span><span class="token string">&quot;game&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Class Entity</span>
<span class="token keyword">auto</span><span class="token operator">&amp;</span> entityCls <span class="token operator">=</span> m<span class="token punctuation">.</span>klass<span class="token operator">&lt;</span>Entity<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;Entity&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
entityCls<span class="token punctuation">.</span>func<span class="token operator">&lt;</span><span class="token operator">&amp;</span>Entity<span class="token operator">::</span>update<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;update&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Class Enemy</span>
<span class="token comment">// Notice how we are adding two classes here as template parameters.</span>
<span class="token comment">// The first template parameter is the class you are binding.</span>
<span class="token comment">// The second and next template parameters are the classes for upcasting.</span>
<span class="token keyword">auto</span><span class="token operator">&amp;</span> enemyCls <span class="token operator">=</span> m<span class="token punctuation">.</span>klass<span class="token operator">&lt;</span>Enemy<span class="token punctuation">,</span> Entity<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;Enemy&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Classes won't automatically inherit functions and properties</span>
<span class="token comment">// therefore you will have to explicitly add them for each</span>
<span class="token comment">// derived class!</span>
enemyCls<span class="token punctuation">.</span>func<span class="token operator">&lt;</span><span class="token operator">&amp;</span>Enemy<span class="token operator">::</span>update<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;update&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Class EntityManager</span>
<span class="token keyword">auto</span><span class="token operator">&amp;</span> mngClass <span class="token operator">=</span>m<span class="token punctuation">.</span>klass<span class="token operator">&lt;</span>EntityManager<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;EntityManager&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
mngClass<span class="token punctuation">.</span>func<span class="token operator">&lt;</span><span class="token operator">&amp;</span>EntityManager<span class="token operator">::</span>add<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;add&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>And then inside of Wren:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token string">&quot;game&quot;</span> <span class="token keyword">for</span> EntityManager<span class="token punctuation">,</span> Enemy

<span class="token keyword">var</span> manager <span class="token operator">=</span> <span class="token operator">...</span>

<span class="token keyword">var</span> e <span class="token operator">=</span> Enemy<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
e<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
manager<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token comment">// ok</span>
</code></pre></div><div class="tip custom-block"><p>Note!</p> <p>Upcasting like this only works when you want accept a reference, pointer, or a shared_ptr of the base class. This won't work with plain value types.</p></div> <h2 id="_17-lists"><a href="#_17-lists" aria-hidden="true" class="header-anchor">#</a> 17. Lists</h2> <h3 id="_17-1-pre-made-stl-vector-and-list-bindings"><a href="#_17-1-pre-made-stl-vector-and-list-bindings" aria-hidden="true" class="header-anchor">#</a> 17.1 Pre-made STL vector and list bindings</h3> <p>Lists are not implemented in this library natively. However, they are added as an optional thing you can use. The <code>std::vector&lt;T&gt;</code> and <code>std::list&lt;T&gt;</code> are implemented via <code>wren::StdVectorBindings&lt;T&gt;::bind(module, name);</code> and as <code>wren::StdListBindings&lt;T&gt;::bind(module, name);</code>. For example:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code>Wren<span class="token operator">::</span>VM vm<span class="token punctuation">;</span>
<span class="token keyword">auto</span><span class="token operator">&amp;</span> m <span class="token operator">=</span> vm<span class="token punctuation">.</span><span class="token function">module</span><span class="token punctuation">(</span><span class="token string">&quot;std&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
wren<span class="token operator">::</span>StdVectorBindings<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token operator">::</span><span class="token function">bind</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token string">&quot;VectorInt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>And then inside of Wren:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token string">&quot;std&quot;</span> <span class="token keyword">for</span> VectorInt

<span class="token keyword">var</span> v <span class="token operator">=</span> VectorInt<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
v<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span> <span class="token comment">// Push new value</span>
v<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token comment">// Insert at the end</span>
v<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span> <span class="token comment">// returns true</span>
v<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// Remove last element and returns it</span>
v<span class="token punctuation">.</span>count <span class="token comment">// Returns the length/size</span>
v<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// Same as the count</span>
v<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// Removes everything</span>
v<span class="token punctuation">.</span><span class="token function">removeAt</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">// Removes the 2nd element from back and returns it</span>
v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">43</span> <span class="token comment">// Set specific index (negative indexes not supported!)</span>
System<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;Second: %(v[1])&quot;</span><span class="token punctuation">)</span> <span class="token comment">// Get specific index (no negative indexes!)</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span>item <span class="token keyword">in</span> v<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// Supports iteration</span>
    System<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;Item: %(item)&quot;</span><span class="token punctuation">)</span> <span class="token comment">// Prints individual elements</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="tip custom-block"><p>Note!</p> <p>I highly recommend going through <code>wrenbind17/include/wrenbind17/std.hpp</code> to see how exactly this works.</p></div> <h3 id="_17-2-custom-lists"><a href="#_17-2-custom-lists" aria-hidden="true" class="header-anchor">#</a> 17.2. Custom lists</h3> <p>If you read through the <a href="http://wren.io/control-flow.html#the-iterator-protocol" target="_blank" rel="noopener noreferrer">Iterator Protocol<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> section on official Wren documentation, then you need to implement at least 2 functions:</p> <ul><li><code>iterate(_)</code></li> <li><code>iteratorValue(_)</code></li></ul> <p>Let's implement all of them for <code>std::vector&lt;int&gt;</code>! First we need the <code>iterate()</code> function. This function must accept already existing iterator or a null. To do this, we will use <code>std::variant</code> and an external function that will be bind to Wren via <code>funcExt</code>.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">typedef</span> <span class="token keyword">typename</span> std<span class="token operator">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token operator">::</span>iterator Iterator<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">typename</span> std<span class="token operator">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> Vector<span class="token punctuation">;</span>

<span class="token keyword">static</span> std<span class="token operator">::</span>variant<span class="token operator">&lt;</span><span class="token keyword">bool</span><span class="token punctuation">,</span> Iterator<span class="token operator">&gt;</span> <span class="token function">iterate</span><span class="token punctuation">(</span>
        Vector<span class="token operator">&amp;</span> self<span class="token punctuation">,</span> <span class="token comment">// this</span>
        std<span class="token operator">::</span>variant<span class="token operator">&lt;</span>std<span class="token operator">::</span>nullptr_t<span class="token punctuation">,</span> Iterator<span class="token operator">&gt;</span> other
    <span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token comment">// Check if &quot;other&quot; variant is NOT nullptr</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>other<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Get the 2nd template, the iterator</span>
        <span class="token keyword">auto</span> it <span class="token operator">=</span> std<span class="token operator">::</span>get<span class="token operator">&lt;</span>Iterator<span class="token operator">&gt;</span><span class="token punctuation">(</span>other<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token operator">++</span>it<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>it <span class="token operator">!=</span> self<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// Return the next position</span>
            <span class="token keyword">return</span> <span class="token punctuation">{</span>it<span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Once we reach the end, we must return false</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// No iterator supplied, the variant is null,</span>
        <span class="token comment">// then return the start of the vector</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>self<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Next, we need the <code>iteratorValue()</code> function. This one is very simple:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">iteratorValue</span><span class="token punctuation">(</span>Vector<span class="token operator">&amp;</span> self<span class="token punctuation">,</span> std<span class="token operator">::</span>shared_ptr<span class="token operator">&lt;</span>Iterator<span class="token operator">&gt;</span> other<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// You could replace the shared_ptr with a simple copy value.</span>
    <span class="token comment">// But that depends on you.</span>
    <span class="token keyword">auto</span><span class="token operator">&amp;</span> it <span class="token operator">=</span> <span class="token operator">*</span>other<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">*</span>it<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>And then bind it!</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code>wren<span class="token operator">::</span>VM vm<span class="token punctuation">;</span>
<span class="token keyword">auto</span><span class="token operator">&amp;</span> m <span class="token operator">=</span> vm<span class="token punctuation">.</span><span class="token function">module</span><span class="token punctuation">(</span><span class="token string">&quot;std&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">auto</span><span class="token operator">&amp;</span> cls <span class="token operator">=</span> m<span class="token punctuation">.</span>klass<span class="token operator">&lt;</span>Vector<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;VectorInt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>ctor<span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>funcExt<span class="token operator">&lt;</span><span class="token operator">&amp;</span>iterate<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;iterate&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>funcExt<span class="token operator">&lt;</span><span class="token operator">&amp;</span>iteratorValue<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;iteratorValue&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>That's all you need to implement your custom list and use it inside of a for loop!</p> <h3 id="_17-3-operator"><a href="#_17-3-operator" aria-hidden="true" class="header-anchor">#</a> 17.3. Operator []</h3> <p>To get the operator [] working, you need two functions to set and to get the index.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">typedef</span> <span class="token keyword">typename</span> std<span class="token operator">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token operator">::</span>iterator Iterator<span class="token punctuation">;</span>
<span class="token keyword">typedef</span> <span class="token keyword">typename</span> std<span class="token operator">::</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> Vector<span class="token punctuation">;</span>

<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">setIndex</span><span class="token punctuation">(</span>Vector<span class="token operator">&amp;</span> self<span class="token punctuation">,</span> size_t index<span class="token punctuation">,</span> <span class="token keyword">int</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    self<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">getIndex</span><span class="token punctuation">(</span>Vector<span class="token operator">&amp;</span> self<span class="token punctuation">,</span> size_t index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> self<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>And then bind it!</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code>wren<span class="token operator">::</span>VM vm<span class="token punctuation">;</span>
<span class="token keyword">auto</span><span class="token operator">&amp;</span> m <span class="token operator">=</span> vm<span class="token punctuation">.</span><span class="token function">module</span><span class="token punctuation">(</span><span class="token string">&quot;std&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">auto</span><span class="token operator">&amp;</span> cls <span class="token operator">=</span> m<span class="token punctuation">.</span>klass<span class="token operator">&lt;</span>Vector<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;VectorInt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>ctor<span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>funcExt<span class="token operator">&lt;</span><span class="token operator">&amp;</span>getIndex<span class="token operator">&gt;</span><span class="token punctuation">(</span>wren<span class="token operator">::</span>OPERATOR_GET_INDEX<span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>funcExt<span class="token operator">&lt;</span><span class="token operator">&amp;</span>setIndex<span class="token operator">&gt;</span><span class="token punctuation">(</span>wren<span class="token operator">::</span>OPERATOR_SET_INDEX<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The enum values you supply instead of function names will create special bindings for overloading operators. Wren will see the following:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">VectorInt</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
    foreign <span class="token punctuation">[</span>index<span class="token punctuation">]</span>         <span class="token comment">// Get</span>
    foreign <span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">(</span>other<span class="token punctuation">)</span> <span class="token comment">// Set</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_18-overload-operators"><a href="#_18-overload-operators" aria-hidden="true" class="header-anchor">#</a> 18. Overload operators</h2> <h3 id="_18-1-arithmetic-and-comparison-operators"><a href="#_18-1-arithmetic-and-comparison-operators" aria-hidden="true" class="header-anchor">#</a> 18.1. Arithmetic and comparison operators</h3> <p>Overloading operators is done same as binding any other methods. The only difference is that you have to use the <a href="https://matusnovak.github.io/wrenbind17/docs/doxygen/namespacewrenbind17.html#enum-foreignmethodoperator" target="_blank" rel="noopener noreferrer">operator enumeration<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> instead of the name. But first, your C++ class must support the operators you want to bind, for example:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Vec3</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Vec3</span><span class="token punctuation">(</span><span class="token keyword">float</span> x<span class="token punctuation">,</span> <span class="token keyword">float</span> y<span class="token punctuation">,</span> <span class="token keyword">float</span> z<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">x</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">y</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">z</span><span class="token punctuation">(</span>z<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    Vec3 <span class="token keyword">operator</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token comment">// Unary negation operator</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span>

    Vec3 <span class="token keyword">operator</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token keyword">const</span> Vec3<span class="token operator">&amp;</span> other<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span>

    Vec3 <span class="token keyword">operator</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token keyword">const</span> Vec3<span class="token operator">&amp;</span> other<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span>

    Vec3 <span class="token keyword">operator</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token keyword">const</span> Vec3<span class="token operator">&amp;</span> other<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span>

    Vec3 <span class="token keyword">operator</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token keyword">const</span> Vec3<span class="token operator">&amp;</span> other<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">bool</span> <span class="token keyword">operator</span> <span class="token operator">==</span> <span class="token punctuation">(</span><span class="token keyword">const</span> Vec3<span class="token operator">&amp;</span> other<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">bool</span> <span class="token keyword">operator</span> <span class="token operator">!=</span> <span class="token punctuation">(</span><span class="token keyword">const</span> Vec3<span class="token operator">&amp;</span> other<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">float</span> x<span class="token punctuation">;</span>
    <span class="token keyword">float</span> y<span class="token punctuation">;</span>
    <span class="token keyword">float</span> z<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>And then bind it in the following way:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token comment">// If you don't do this, the compiler will have no idea</span>
<span class="token comment">// which operator to use when binding OPERATOR_SUB and OPERATOR_NEG.</span>
<span class="token comment">// With this and static_cast you will explicitly tell the compiler</span>
<span class="token comment">// which exact function to use.</span>
<span class="token keyword">typedef</span> Vec3 <span class="token punctuation">(</span>Vec3<span class="token operator">::</span><span class="token operator">*</span>Vec3Sub<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">const</span> Vec3<span class="token operator">&amp;</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
<span class="token keyword">typedef</span> Vec3 <span class="token punctuation">(</span>Vec3<span class="token operator">::</span><span class="token operator">*</span>Vec3Neg<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>

<span class="token comment">// Bind the class and some basic functions/vars</span>
<span class="token keyword">auto</span><span class="token operator">&amp;</span> cls <span class="token operator">=</span> m<span class="token punctuation">.</span>klass<span class="token operator">&lt;</span>Vec3<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;Vec3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>ctor<span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token punctuation">,</span> <span class="token keyword">float</span><span class="token punctuation">,</span> <span class="token keyword">float</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Constructor</span>
cls<span class="token punctuation">.</span>var<span class="token operator">&lt;</span><span class="token operator">&amp;</span>Vec3<span class="token operator">::</span>x<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;x&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>var<span class="token operator">&lt;</span><span class="token operator">&amp;</span>Vec3<span class="token operator">::</span>y<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;y&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>var<span class="token operator">&lt;</span><span class="token operator">&amp;</span>Vec3<span class="token operator">::</span>z<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Bind the operators</span>
cls<span class="token punctuation">.</span>func<span class="token operator">&lt;</span><span class="token operator">&amp;</span>Vec3<span class="token operator">::</span><span class="token keyword">operator</span><span class="token operator">+</span> <span class="token operator">&gt;</span><span class="token punctuation">(</span>wren<span class="token operator">::</span>OPERATOR_ADD<span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>func<span class="token operator">&lt;</span><span class="token keyword">static_cast</span><span class="token operator">&lt;</span>Vec3Sub<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Vec3<span class="token operator">::</span><span class="token keyword">operator</span><span class="token operator">-</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>wren<span class="token operator">::</span>OPERATOR_SUB<span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>func<span class="token operator">&lt;</span><span class="token keyword">static_cast</span><span class="token operator">&lt;</span>Vec3Neg<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Vec3<span class="token operator">::</span><span class="token keyword">operator</span><span class="token operator">-</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>wren<span class="token operator">::</span>OPERATOR_NEG<span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>func<span class="token operator">&lt;</span><span class="token operator">&amp;</span>Vec3<span class="token operator">::</span><span class="token keyword">operator</span><span class="token operator">*</span> <span class="token operator">&gt;</span><span class="token punctuation">(</span>wren<span class="token operator">::</span>OPERATOR_MUL<span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>func<span class="token operator">&lt;</span><span class="token operator">&amp;</span>Vec3<span class="token operator">::</span><span class="token keyword">operator</span><span class="token operator">/</span> <span class="token operator">&gt;</span><span class="token punctuation">(</span>wren<span class="token operator">::</span>OPERATOR_DIV<span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>func<span class="token operator">&lt;</span><span class="token operator">&amp;</span>Vec3<span class="token operator">::</span><span class="token keyword">operator</span><span class="token operator">==</span> <span class="token operator">&gt;</span><span class="token punctuation">(</span>wren<span class="token operator">::</span>OPERATOR_EQUAL<span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>func<span class="token operator">&lt;</span><span class="token operator">&amp;</span>Vec3<span class="token operator">::</span><span class="token keyword">operator</span><span class="token operator">!=</span> <span class="token operator">&gt;</span><span class="token punctuation">(</span>wren<span class="token operator">::</span>OPERATOR_NOT_EQUAL<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>And then inside of Wren:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token string">&quot;test&quot;</span> <span class="token keyword">for</span> Vec3
<span class="token keyword">var</span> a <span class="token operator">=</span> Vec3<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">2.0</span><span class="token punctuation">,</span> <span class="token number">3.0</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> Vec3<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">4.0</span><span class="token punctuation">,</span> <span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token number">6.0</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> c <span class="token operator">=</span> a <span class="token operator">+</span> b
</code></pre></div><p>Here is a list of all supported operators:</p> <table><thead><tr><th>Operator</th> <th>Enum Value</th></tr></thead> <tbody><tr><td>Add (+)</td> <td>OPERATOR_ADD</td></tr> <tr><td>Subtract (-)</td> <td>OPERATOR_SUB</td></tr> <tr><td>Multiply (*)</td> <td>OPERATOR_MUL</td></tr> <tr><td>Divide (/)</td> <td>OPERATOR_DIV</td></tr> <tr><td>Unary negative (-)</td> <td>OPERATOR_NEG</td></tr> <tr><td>Modulo (%)</td> <td>OPERATOR_MOD</td></tr> <tr><td>Equal to (==)</td> <td>OPERATOR_EQUAL</td></tr> <tr><td>Not equal to (!=)</td> <td>OPERATOR_NOT_EQUAL</td></tr> <tr><td>Greater than (&gt;)</td> <td>OPERATOR_GT</td></tr> <tr><td>Less than (&lt;)</td> <td>OPERATOR_LT</td></tr> <tr><td>Greather than or equal (&gt;=)</td> <td>OPERATOR_GT_EQUAL</td></tr> <tr><td>Less than or equal (&lt;=)</td> <td>OPERATOR_LT_EQUAL</td></tr> <tr><td>Shift left (&lt;&lt;)</td> <td>OPERATOR_SHIFT_LEFT</td></tr> <tr><td>Shift right (&gt;&gt;)</td> <td>OPERATOR_SHIFT_RIGHT</td></tr> <tr><td>Binary and (&amp;)</td> <td>OPERATOR_AND</td></tr> <tr><td>Binary xor (^)</td> <td>OPERATOR_XOR</td></tr> <tr><td>Binary or (|)</td> <td>OPERATOR_OR</td></tr> <tr><td>Get by index []</td> <td>OPERATOR_GET_INDEX</td></tr> <tr><td>Set by index []</td> <td>OPERATOR_SET_INDEX</td></tr></tbody></table> <div class="tip custom-block"><p>Note!</p> <p>If you are using Visual Studio and trying to bind operator <code>&lt;</code> then you might get an error: <code>error C2833: 'operator &gt;' is not a recognized operator or type</code>. This happens because the compiler is unable to understand <code>cls.func&lt;&amp;Vec3::operator&gt; &gt;(wren::OPERATOR_GT)</code>. Simply, put <code>(...)</code> around the operator like this: <code>cls.func&lt;(&amp;Vec3::operator&gt;)&gt;(wren::OPERATOR_GT)</code>. That will fix the problem.</p></div> <div class="warning custom-block"><p>Warning!</p> <p>Using <code>*=</code>, <code>-=</code>, <code>+=</code>, or <code>/=</code> is not allowed. Wren does not support these assignment operators, and results in Wren compilation error.</p></div> <h3 id="_18-2-operator-with-multiple-types"><a href="#_18-2-operator-with-multiple-types" aria-hidden="true" class="header-anchor">#</a> 18.2. Operator with multiple types</h3> <p>Consider the following C++ class:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Vec3</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    Vec3 <span class="token keyword">operator</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token keyword">const</span> Vec3<span class="token operator">&amp;</span> other<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span>

    Vec3 <span class="token keyword">operator</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">float</span> value<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>You have two operators but the second one only accepts a single value. This can be useful when you want to, for example, multiply a 3D vector with a constant value. But this can be a problem when binding these two operators to Wren. You can't bind them both, but you can use <code>std::variant&lt;&gt;</code> instead.</p> <p>Create a new function in the following way:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code>Vec3 <span class="token keyword">operator</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>variant<span class="token operator">&lt;</span>Vec3<span class="token punctuation">,</span> <span class="token keyword">float</span><span class="token operator">&gt;</span><span class="token operator">&amp;</span> var<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>var<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Vec3 other <span class="token operator">=</span> std<span class="token operator">::</span>get<span class="token operator">&lt;</span>Vec3<span class="token operator">&gt;</span><span class="token punctuation">(</span>var<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Multiply by other vector</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">float</span> other <span class="token operator">=</span> std<span class="token operator">::</span>get<span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>var<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Multiply by constant value</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">auto</span><span class="token operator">&amp;</span> cls <span class="token operator">=</span> m<span class="token punctuation">.</span>klass<span class="token operator">&lt;</span>Vec3<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;Vec3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>ctor<span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token punctuation">,</span> <span class="token keyword">float</span><span class="token punctuation">,</span> <span class="token keyword">float</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>var<span class="token operator">&lt;</span><span class="token operator">&amp;</span>Vec3<span class="token operator">::</span>x<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;x&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>var<span class="token operator">&lt;</span><span class="token operator">&amp;</span>Vec3<span class="token operator">::</span>y<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;y&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cls<span class="token punctuation">.</span>var<span class="token operator">&lt;</span><span class="token operator">&amp;</span>Vec3<span class="token operator">::</span>z<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&quot;z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Optional typedef to explicitly select the correct operator with std::variant</span>
<span class="token keyword">typedef</span> Vec3 <span class="token punctuation">(</span>Vec3<span class="token operator">::</span><span class="token operator">*</span>Vec3Mul<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>variant<span class="token operator">&lt;</span>Vec3<span class="token punctuation">,</span> <span class="token keyword">float</span><span class="token operator">&gt;</span><span class="token operator">&amp;</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
<span class="token comment">// Bind the function</span>
cls<span class="token punctuation">.</span>func<span class="token operator">&lt;</span><span class="token keyword">static_cast</span><span class="token operator">&lt;</span>Vec3Mul<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Vec3<span class="token operator">::</span><span class="token keyword">operator</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>wren<span class="token operator">::</span>OPERATOR_MUL<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Then, insie of Wren, you can do the following:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token string">&quot;test&quot;</span> <span class="token keyword">for</span> Vec3
<span class="token keyword">var</span> a <span class="token operator">=</span> Vec3<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">2.0</span><span class="token punctuation">,</span> <span class="token number">3.0</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> Vec3<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">4.0</span><span class="token punctuation">,</span> <span class="token number">5.0</span><span class="token punctuation">,</span> <span class="token number">6.0</span><span class="token punctuation">)</span>

<span class="token comment">// Multiply by other vector</span>
<span class="token keyword">var</span> c <span class="token operator">=</span> a <span class="token operator">+</span> b

<span class="token comment">// Or multiply by a constant value</span>
<span class="token keyword">var</span> c <span class="token operator">=</span> a <span class="token operator">*</span> <span class="token number">1.5</span>
</code></pre></div><h2 id="_19-using-std-variant"><a href="#_19-using-std-variant" aria-hidden="true" class="header-anchor">#</a> 19. Using std::variant</h2> <p>Using <code>std::variant</code> is nothing special. When you pass it into Wren, what happens is that this library will check what type is being held by the variant, and then it will push it into Wren. <strong>The Wren will not get the variant instace, but the value it holds!</strong> For example, passing <code>std::variant&lt;bool, int&gt;</code> will push either bool or int into Wren.</p> <p>The same goes for getting values from Wren as variant. Suppose you have a C++ member function that accepts the variant of <code>std::variant&lt;bool, int&gt;</code> then when you call this member function in Wren as <code>foo.set(true)</code> or <code>foo.set(42)</code> it will work, but <code>foo.set(&quot;Hello&quot;)</code> won't work because the variant does not accepts the string!</p> <h2 id="_20-customize-vm-behavior"><a href="#_20-customize-vm-behavior" aria-hidden="true" class="header-anchor">#</a> 20. Customize VM behavior</h2> <p>TODO</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/wrenbind17/assets/js/app.6ecae263.js" defer></script><script src="/wrenbind17/assets/js/2.4fd91003.js" defer></script><script src="/wrenbind17/assets/js/151.bbd6ded7.js" defer></script>
  </body>
</html>
